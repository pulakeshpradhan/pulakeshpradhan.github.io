var Agriculture = /* color: #d63000 */ee.Geometry.MultiPolygon(
        [[[[73.49012290434916, 24.578837723818083],
           [73.48995660739024, 24.57834988816377],
           [73.49042331175883, 24.57836940162641],
           [73.49042867617686, 24.578564536085718]]],
         [[[73.48485875458573, 24.576043226588197],
           [73.48472464413499, 24.575809060487796],
           [73.48495531411027, 24.575809060487796]]],
         [[[73.48473537297104, 24.57533340924891],
           [73.4849445852742, 24.575418782681172],
           [73.4849445852742, 24.57569197727346],
           [73.48469513983582, 24.57568222033399]]],
         [[[73.48501968712662, 24.5761895801787],
           [73.48505455584382, 24.575423661161256],
           [73.485266450356, 24.575401707999365],
           [73.48523962826584, 24.57616518792549]]],
         [[[73.48542201847886, 24.575918825901848],
           [73.48537910313462, 24.57520656861356],
           [73.48564195961808, 24.575187054658265],
           [73.48554003567551, 24.575550501576828],
           [73.48565268845414, 24.576131038763013],
           [73.48549175591324, 24.576143234893546]]],
         [[[73.48575552669945, 24.57600719630443],
           [73.48657360044899, 24.57640722916183],
           [73.4865038630146, 24.576680421598706],
           [73.48580917087975, 24.576382836950998]]],
         [[[73.48511447874489, 24.57699508000651],
           [73.48490526644173, 24.576641394144204],
           [73.48572602240029, 24.5765194332705],
           [73.48573406902733, 24.576877997900585],
           [73.4852432247776, 24.576838970507627]]],
         [[[73.48586817947808, 24.577036546559448],
           [73.48579844204369, 24.576838970507627],
           [73.48593255249443, 24.57672432747049],
           [73.48603715864601, 24.576851166569238]]],
         [[[73.48676940170708, 24.576504797957664],
           [73.48715295759621, 24.576895072381177],
           [73.48701080051842, 24.577097526759438],
           [73.48662724462929, 24.57679018624933]]],
         [[[73.48683377472344, 24.577068256267157],
           [73.48693301645699, 24.57716338534209],
           [73.48685791460457, 24.577256075140475],
           [73.48674526182594, 24.577199973428584]]],
         [[[73.484741949988, 24.574835449775247],
           [73.48516842122137, 24.574608599185254],
           [73.4850289463526, 24.574476879299354],
           [73.48535885806143, 24.574462243747934],
           [73.48529448504507, 24.575091570915447],
           [73.484741949988, 24.575137916589643]]],
         [[[73.4862171649462, 24.57406708321322],
           [73.48652025456488, 24.574040251279882],
           [73.48656585211813, 24.574215878375668],
           [73.48621180052817, 24.57428173847311]]],
         [[[73.48832738896829, 24.572444427243507],
           [73.48808867236596, 24.5722419653463],
           [73.48835957547647, 24.57198339907419],
           [73.48881286879998, 24.572393201975128],
           [73.48843199511987, 24.57282007857178],
           [73.48821741839868, 24.572654206695557]]],
         [[[73.48846554900638, 24.571912420045404],
           [73.48894298221103, 24.571470904455794],
           [73.48914146567813, 24.571395285607633],
           [73.48934531356326, 24.571439193331482],
           [73.48879546071521, 24.572224651125484]]],
         [[[73.48929696892833, 24.571117251270625],
           [73.4894364437971, 24.571158719768913],
           [73.48940425728892, 24.571322154304937],
           [73.4892191848669, 24.571314836345202]]],
         [[[73.48873102282619, 24.56990246211459],
           [73.48919504498576, 24.57024153095532],
           [73.48879539584254, 24.57060499221904],
           [73.48832064484691, 24.57018054741853]]],
         [[[73.48895959556444, 24.569772112619344],
           [73.48933510482652, 24.570013608038167],
           [73.48923318088396, 24.57015265064395],
           [73.48887376487596, 24.569884322669804]]],
         [[[73.48897837102754, 24.569484268986987],
           [73.48911248147829, 24.569584282527405],
           [73.48906956613405, 24.569689174691383],
           [73.48887912929399, 24.569584282527405]]],
         [[[73.48941825330598, 24.56952085931591],
           [73.48953895271165, 24.569603797355256],
           [73.48944775760515, 24.56969405339455],
           [73.4893136471544, 24.569606236708527]]],
         [[[73.48953090608461, 24.56932327141277],
           [73.48980717361314, 24.569606236708527],
           [73.48970256746156, 24.56966234182058],
           [73.4894021600519, 24.569386694724273]]]]),
    trees = /* color: #98ff00 */ee.Geometry.MultiPolygon(
        [[[[73.48711402673871, 24.594047100246193],
           [73.48503563200279, 24.591428820092343],
           [73.48535311325907, 24.59123748208786],
           [73.48695159446811, 24.592868880953688],
           [73.48759024862329, 24.593976608805537]]],
         [[[73.48400030350706, 24.595344250638885],
           [73.48246607995054, 24.592876108073106],
           [73.4843328974249, 24.591802987431265],
           [73.48441872811338, 24.59386141983441],
           [73.48618898606321, 24.59449552726234]]],
         [[[73.47928235653342, 24.593622262434458],
           [73.48003337505759, 24.595114851498266],
           [73.47862789753378, 24.595787974076554],
           [73.47770521763266, 24.5940612610654]]],
         [[[73.47301298721936, 24.587444598301055],
           [73.47157532318738, 24.582303068308857],
           [73.47349578484204, 24.58162987323232],
           [73.47503000839856, 24.58611777206017],
           [73.47654277428296, 24.587649474629327]]],
         [[[73.47879582985547, 24.587337281995318],
           [73.47623163803723, 24.58595191779155],
           [73.4786563549867, 24.585454353667718],
           [73.48005110367444, 24.586829967304975]]]]),
    NonAgri = /* color: #0b4a8b */ee.Geometry.MultiPolygon(
        [[[[73.51834843119741, 24.571474355005623],
           [73.51788215099214, 24.571160669807913],
           [73.51831649419705, 24.570928309895947],
           [73.5184953413991, 24.57114905182256]]],
         [[[73.51743829597262, 24.56961931862446],
           [73.51698768485812, 24.569336353358242],
           [73.51762336839465, 24.569177794955625],
           [73.51784599174289, 24.56950710833671]]],
         [[[73.5249920709615, 24.56950450071425],
           [73.52592011528066, 24.56873122272248],
           [73.52625002698949, 24.56983137388801],
           [73.52519323663762, 24.569809419746317]]],
         [[[73.52460931970347, 24.566519472591942],
           [73.52299999429454, 24.566002315900327],
           [73.5230107231306, 24.56445083302288],
           [73.52251719667186, 24.563660447569962],
           [73.52357935144175, 24.56327013192787],
           [73.52420162393321, 24.563494563570572],
           [73.52343987657298, 24.56451913770461],
           [73.52370809747447, 24.565553461193034],
           [73.52552127076854, 24.566138923535686]]],
         [[[73.52453721429617, 24.557248968700073],
           [73.52490189205378, 24.55751790735578],
           [73.52428095425012, 24.55786752674586]]],
         [[[73.4905208761736, 24.571096707346847],
           [73.49120215726339, 24.570555176197416],
           [73.49045650315725, 24.57135039681009],
           [73.48944262814962, 24.572170005412087],
           [73.48904029679738, 24.572906672854693],
           [73.48876671147787, 24.572726165338885]]],
         [[[73.489896111196, 24.56903023360457],
           [73.48901098222109, 24.568195968183957],
           [73.48929529637667, 24.567854454421507]]],
         [[[73.48863163957321, 24.566318464857044],
           [73.48867455491745, 24.5668990448146],
           [73.48786452779495, 24.567099075941773]]],
         [[[73.4883956051799, 24.565654941612543],
           [73.48926464090073, 24.565186570148697],
           [73.48953286180222, 24.56583545931364],
           [73.48874429235184, 24.565625668447318]]],
         [[[73.50379174158104, 24.5489760324277],
           [73.5049182693673, 24.553269927116727],
           [73.50418870851524, 24.555211890300647],
           [73.50351279184349, 24.550020243072165]]],
         [[[73.50466290887562, 24.54992352429126],
           [73.50605765756336, 24.550577371894757],
           [73.50634733613697, 24.55242178930324],
           [73.50517789300648, 24.552812138716305]]],
         [[[73.53709763601807, 24.542121345120364],
           [73.53593892172364, 24.540215778158995],
           [73.53725856855897, 24.54024749718007],
           [73.53860771969346, 24.541579688825344]]]]);
var point = ee.Geometry.Point(73.374182, 24.4853)
var addNDVI = function(image) {
  // var dateString = ee.Date(image.get('system:time_start')).format('yyyy-MM-dd');
  return image.addBands(image.normalizedDifference(['B8', 'B4']).rename('ndvi'));
};
var images = ee.ImageCollection('COPERNICUS/S2').filterBounds(point)
.filterDate('2017-09-25', '2018-04-30')
.filter(ee.Filter.lt('CLOUDY_PIXEL_PERCENTAGE', 5)).map(addNDVI)
print (images)
// function showOnMap(image)
// {
//   print(image.id)
//   var ndvi = ee.Image(image.id)
//   print (ndvi)
//   var palette = ['FFFFFF', 'CE7E45', 'DF923D', 'F1B555', 'FCD163', '99B718',
//               '74A901', '66A000', '529400', '3E8601', '207401', '056201',
//               '004C00', '023B01', '012E01', '011D01', '011301'];
//   Map.addLayer(ndvi, {bands: ['ndvi'],min: 0, max: 1, palette: palette}, 'NDVI');
//   return  ndvi
// }
function onlyNdvi(image, list){
  return ee.List(list).add(ee.Image(image.select(['ndvi'])))
}
var ndviList =  ee.List([])
images  = ee.ImageCollection(ee.List(images.iterate(onlyNdvi,ndviList)))
var stackCollection = function(collection) {
  // Create an initial image.
  var first = ee.Image(collection.first()).select([]);
  // Write a function that appends a band to an image.
  var appendBands = function(image, previous) {
    return ee.Image(previous).addBands(image);
  };
  return ee.Image(collection.iterate(appendBands, first));
};
var stacked = stackCollection(images);
print(stacked)
var palette = ['0000FF', 'CE7E45', 'DF923D', 'F1B555', 'FCD163', '99B718',
               '74A901', '66A000', '529400', '3E8601', '207401', '056201',
               '004C00', '023B01', '012E01', '011D01', '011301'];
//Map.addLayer(stacked, {min: 0, max: 1},"NDVI")
//Map.addLayer(images.sum(), {bands: ['ndvi'],min: 0, max: 29, palette: palette},"NDVI_sum")
Map.centerObject(point,16)
var features = [
  ee.Feature(trees, {'class': 0}),
  ee.Feature(NonAgri, {'class':1}),
   ee.Feature(Agriculture, {'class':2})
];
var polyFeatureCollect = ee.FeatureCollection(features)
var training = stacked.sampleRegions({
  collection: polyFeatureCollect,
  properties: ['class'],
  scale: 10
});
// Train a CART classifier with default parameters.
var trained = ee.Classifier.svm().train(training, 'class');
// Classify the image with the same bands used for training.
var classified = stacked.classify(trained);
var tree = classified.eq(0)
// // Display the inputs and the results.
// Map.centerObject(image, 10);
// Map.addLayer(image, {bands: ['B4', 'B3', 'B2'], max: 0.4}, 'image');
//Map.addLayer(classified.randomVisualizer(),{},'classification')
// Map.addLayer(land.randomVisualizer(),{},'agri');
var treeArea = classified.updateMask(tree)
Map.addLayer(treeArea.randomVisualizer(),{},'Tree/Forest Area ',false)
var nonAg = classified.eq(1)
// // Display the inputs and the results.
// Map.centerObject(image, 10);
// Map.addLayer(image, {bands: ['B4', 'B3', 'B2'], max: 0.4}, 'image');
//Map.addLayer(classified.randomVisualizer(),{},'classification')
// Map.addLayer(land.randomVisualizer(),{},'agri');
var nonAgri = classified.updateMask(nonAg)
Map.addLayer(nonAgri.randomVisualizer(),{},'Non Agriculture Area ',false)
var land = classified.eq(2)
print(land)
// // Display the inputs and the results.
// Map.centerObject(image, 10);
// Map.addLayer(image, {bands: ['B4', 'B3', 'B2'], max: 0.4}, 'image');
//Map.addLayer(classified.randomVisualizer(),{},'classification')
// Map.addLayer(land.randomVisualizer(),{},'agri');
var crop = classified.updateMask(land)
Map.addLayer(crop.randomVisualizer(),{},'Agriculture Area ',true)