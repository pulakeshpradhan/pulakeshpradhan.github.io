var geometry2 = /* color: #d63000 */ee.Geometry.Polygon(
        [[[119.77572832831675, 11.89725568550665],
          [119.85881243476206, 11.829385780222111],
          [119.88353167304331, 11.73864229428098],
          [119.943269832223, 11.60146219677188],
          [120.12935076484018, 11.616931968505611],
          [120.21449480780893, 11.674767846648143],
          [120.26599322089487, 11.766204595678245],
          [120.305818660348, 11.778304246292425],
          [120.38958941230112, 11.852234960186653],
          [120.46924029120737, 12.013468703476892],
          [120.30787859687143, 12.219572705861802],
          [120.13484392890268, 12.306799810870736],
          [119.899324519723, 12.458371728419854],
          [119.73590288886362, 12.279292841360336],
          [119.75856219062143, 11.977199481035878]]]),
    srtm = ee.Image("USGS/SRTMGL1_003"),
    GMWtable = ee.FeatureCollection("users/jackreid/GMW_2016_v2"),
    loi1 = /* color: #98ff00 */ee.Geometry.Point([0.7505796906091291, 5.806424921643327]),
    loi2 = /* color: #0b4a8b */ee.Geometry.Point([0.7041007537756059, 5.890727862401042]),
    ghanaregion = /* color: #d63000 */ee.Geometry.Polygon(
        [[[-2.0033566494337265, 4.701282084696781],
          [0.8860605187370538, 5.696915387730834],
          [1.248611517097288, 5.937370334105299],
          [1.0343775249801865, 6.2159490801721855],
          [0.04560289760502201, 6.259635677021779],
          [-0.09172727398663483, 5.778901498861587],
          [-2.003356845442795, 4.925708244299138],
          [-2.508730327738135, 5.166470990163713],
          [-3.085515117553882, 5.210235557113463],
          [-3.123967145217989, 5.051571429747808]]]),
    mangrovePoints = 
    /* color: #98ff00 */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.MultiPolygon(
        [[[[0.7360243171152661, 5.8231344907466305],
           [0.7360243171152661, 5.82091440389838],
           [0.7401441901621411, 5.82091440389838],
           [0.7401441901621411, 5.8231344907466305]]],
         [[[0.7801412909922192, 5.824671468810239],
           [0.7801412909922192, 5.822963715146644],
           [0.7816862433847973, 5.822963715146644],
           [0.7816862433847973, 5.824671468810239]]],
         [[[0.7949041694101879, 5.864289893053361],
           [0.7949041694101879, 5.8610453862435605],
           [0.7979940741953442, 5.8610453862435605],
           [0.7979940741953442, 5.864289893053361]]],
         [[[0.8299230903086254, 5.840041017940697],
           [0.8299230903086254, 5.836796370424124],
           [0.8323263495859692, 5.836796370424124],
           [0.8323263495859692, 5.840041017940697]]],
         [[[0.8407377570566723, 5.841236409657258],
           [0.8407377570566723, 5.838674852855336],
           [0.8419393866953442, 5.838674852855336],
           [0.8419393866953442, 5.841236409657258]]],
         [[[0.8540415137705395, 5.845740451952843],
           [0.8540415137705395, 5.845334876169245],
           [0.854427751868684, 5.845334876169245],
           [0.854427751868684, 5.845740451952843]]],
         [[[0.8565306037363598, 5.847234675987557],
           [0.8565306037363598, 5.8468077552419455],
           [0.8568739264902661, 5.8468077552419455],
           [0.8568739264902661, 5.847234675987557]]],
         [[[0.8565949767527172, 5.845825836290885],
           [0.8565949767527172, 5.845334876169245],
           [0.8570241301951, 5.845334876169245],
           [0.8570241301951, 5.845825836290885]]],
         [[[0.8433126777109692, 5.850030998815167],
           [0.8433126777109692, 5.848856971849625],
           [0.8446215957102368, 5.848856971849625],
           [0.8446215957102368, 5.850030998815167]]],
         [[[0.8401369422373364, 5.845356222270521],
           [0.8401369422373364, 5.844310262354261],
           [0.8408021300730297, 5.844310262354261],
           [0.8408021300730297, 5.845356222270521]]],
         [[[0.861068901389558, 5.849806866584832],
           [0.861068901389558, 5.849550715354451],
           [0.8612083762583325, 5.849550715354451],
           [0.8612083762583325, 5.849806866584832]]],
         [[[0.8311634634512757, 5.861857395518468],
           [0.8311634634512757, 5.860747429946955],
           [0.8315067862051819, 5.860747429946955],
           [0.8315067862051819, 5.861857395518468]]],
         [[[-0.2967896627767459, 5.531006565316911],
           [-0.2967896627767459, 5.528956215926642],
           [-0.29550220244959746, 5.528956215926642],
           [-0.29550220244959746, 5.531006565316911]]],
         [[[-0.29301311248377715, 5.528956215926642],
           [-0.29301311248377715, 5.528187333074054],
           [-0.29163982146815215, 5.528187333074054],
           [-0.29163982146815215, 5.528956215926642]]],
         [[[-0.2781842038911009, 5.530009418451786],
           [-0.2781842038911009, 5.529550225463162],
           [-0.27805545785838603, 5.529550225463162],
           [-0.27805545785838603, 5.530009418451786]]],
         [[[-0.2772293374817991, 5.531888902319111],
           [-0.2772293374817991, 5.531707361524179],
           [-0.276982574252429, 5.531707361524179],
           [-0.276982574252429, 5.531888902319111]]],
         [[[-0.3231709004135155, 5.509931255766387],
           [-0.3231709004135155, 5.509407971588844],
           [-0.32255935675812, 5.509407971588844],
           [-0.32255935675812, 5.509931255766387]]],
         [[[-0.3246085644454979, 5.50983514238058],
           [-0.3246085644454979, 5.509493405771763],
           [-0.3242759705276512, 5.509493405771763],
           [-0.3242759705276512, 5.50983514238058]]],
         [[[-0.3265612126083397, 5.509407971588844],
           [-0.3265612126083397, 5.5092157446323275],
           [-0.326378822395327, 5.5092157446323275],
           [-0.326378822395327, 5.509407971588844]]],
         [[[-0.3276555538864159, 5.509226423909334],
           [-0.3276555538864159, 5.508938083363128],
           [-0.32740879065704576, 5.508938083363128],
           [-0.32740879065704576, 5.509226423909334]]],
         [[[-0.3204886913986229, 5.510721520793313],
           [-0.3204886913986229, 5.510507935754626],
           [-0.32000589377594224, 5.510507935754626],
           [-0.32000589377594224, 5.510721520793313]]],
         [[[-0.9427757866724278, 5.206315982739251],
           [-0.9427757866724278, 5.20623050614791],
           [-0.9422608025415684, 5.20623050614791],
           [-0.9422608025415684, 5.206315982739251]]],
         [[[-0.939600051198795, 5.212470266768988],
           [-0.939600051198795, 5.211743722486853],
           [-0.9393425591333653, 5.211743722486853],
           [-0.9393425591333653, 5.212470266768988]]],
         [[[-0.942046225820377, 5.2134959749129175],
           [-0.942046225820377, 5.213025858888241],
           [-0.9416599877222325, 5.213025858888241],
           [-0.9416599877222325, 5.2134959749129175]]],
         [[[-0.9332914955957676, 5.2179834283386395],
           [-0.9332914955957676, 5.21781247831986],
           [-0.9331198342188145, 5.21781247831986],
           [-0.9331198342188145, 5.2179834283386395]]],
         [[[-0.9161253579004551, 5.218667227948003],
           [-0.9161253579004551, 5.218496278115552],
           [-0.9158249504907872, 5.218496278115552],
           [-0.9158249504907872, 5.218667227948003]]],
         [[[-0.9133787758692051, 5.216359401279628],
           [-0.9133787758692051, 5.215590123837414],
           [-0.912906707082584, 5.215590123837414],
           [-0.912906707082584, 5.216359401279628]]],
         [[[-0.9090081337885749, 5.212202797239922],
           [-0.9090081337885749, 5.211828840569824],
           [-0.9087613705592048, 5.211828840569824],
           [-0.9087613705592048, 5.212202797239922]]],
         [[[-0.9095016602473152, 5.213025501130392],
           [-0.9095016602473152, 5.212737020668111],
           [-0.9092441681818855, 5.212737020668111],
           [-0.9092441681818855, 5.213025501130392]]],
         [[[-0.9084931496577155, 5.211786102650502],
           [-0.9084931496577155, 5.211433514705079],
           [-0.9082249287562263, 5.211433514705079],
           [-0.9082249287562263, 5.211786102650502]]],
         [[[-2.421462815308473, 4.953114209719931],
           [-2.421462815308473, 4.952686658733403],
           [-2.420990746521852, 4.952686658733403],
           [-2.420990746521852, 4.953114209719931]]],
         [[[-2.4291017465828872, 4.961323135014876],
           [-2.4291017465828872, 4.959698459981905],
           [-2.4288013391732193, 4.959698459981905],
           [-2.4288013391732193, 4.961323135014876]]],
         [[[-2.418973725342653, 4.957261439936798],
           [-2.418973725342653, 4.956705627088297],
           [-2.417900841736696, 4.956705627088297],
           [-2.417900841736696, 4.957261439936798]]],
         [[[-2.380126497624474, 4.941781837380029],
           [-2.380126497624474, 4.941482546594434],
           [-2.3796115134936144, 4.941482546594434],
           [-2.3796115134936144, 4.941781837380029]]],
         [[[-2.3805341933947375, 4.942337662766073],
           [-2.3805341933947375, 4.942016994331027],
           [-2.3802552436571887, 4.942016994331027],
           [-2.3802552436571887, 4.942337662766073]]],
         [[[-2.3780880187731555, 4.941033610162584],
           [-2.3780880187731555, 4.940755696980958],
           [-2.377594492314415, 4.940755696980958],
           [-2.377594492314415, 4.941033610162584]]],
         [[[-2.376156828282433, 4.940691563153256],
           [-2.376156828282433, 4.9401784923082905],
           [-2.375598928807335, 4.9401784923082905],
           [-2.375598928807335, 4.940691563153256]]],
         [[[-2.3745475028734973, 4.942551441636552],
           [-2.3745475028734973, 4.9423804185456985],
           [-2.3742470954638293, 4.9423804185456985],
           [-2.3742470954638293, 4.942551441636552]]],
         [[[-2.37347461926754, 4.939879200798662],
           [-2.37347461926754, 4.939473019248043],
           [-2.3731956695299914, 4.939473019248043],
           [-2.3731956695299914, 4.939879200798662]]],
         [[[-2.374032518742638, 4.940092980462193],
           [-2.374032518742638, 4.939729554993175],
           [-2.373753569005089, 4.939729554993175],
           [-2.373753569005089, 4.940092980462193]]],
         [[[-2.60452147857427, 5.020372327138166],
           [-2.60452147857427, 5.020008946037873],
           [-2.604070867459768, 5.020008946037873],
           [-2.604070867459768, 5.020372327138166]]],
         [[[-2.600380147855276, 5.020436453193661],
           [-2.600380147855276, 5.020137198214039],
           [-2.6001441134619654, 5.020137198214039],
           [-2.6001441134619654, 5.020436453193661]]],
         [[[-2.5995218409705103, 5.020521954591205],
           [-2.5995218409705103, 5.020372327138166],
           [-2.5993930949377955, 5.020372327138166],
           [-2.5993930949377955, 5.020521954591205]]],
         [[[-2.608190740506643, 5.024583258059302],
           [-2.608190740506643, 5.024155753622633],
           [-2.6078045024084986, 5.024155753622633],
           [-2.6078045024084986, 5.024583258059302]]],
         [[[-2.6059591426062525, 5.02573751863741],
           [-2.6059591426062525, 5.025352765338563],
           [-2.6056158198523462, 5.025352765338563],
           [-2.6056158198523462, 5.02573751863741]]],
         [[[-2.5876557482886255, 5.023621372682447],
           [-2.5876557482886255, 5.023386244929959],
           [-2.5872265948462427, 5.023386244929959],
           [-2.5872265948462427, 5.023621372682447]]],
         [[[-2.597204412381643, 5.019816567726368],
           [-2.597204412381643, 5.0192180570610265],
           [-2.5969469203162134, 5.0192180570610265],
           [-2.5969469203162134, 5.019816567726368]]],
         [[[-2.6502629898079704, 5.030059558070248],
           [-2.6502629898079704, 5.0285205537239905],
           [-2.6484605453499626, 5.0285205537239905],
           [-2.6484605453499626, 5.030059558070248]]],
         [[[-2.643825688172228, 5.035446044621541],
           [-2.643825688172228, 5.03518954627336],
           [-2.643654026795275, 5.03518954627336],
           [-2.643654026795275, 5.035446044621541]]],
         [[[-2.638160862732775, 5.035104046801477],
           [-2.638160862732775, 5.034591049734133],
           [-2.6377317092903922, 5.034591049734133],
           [-2.6377317092903922, 5.035104046801477]]],
         [[[-2.6560994766243766, 5.02976030751007],
           [-2.6560994766243766, 5.028435053375878],
           [-2.6546832702645133, 5.028435053375878],
           [-2.6546832702645133, 5.02976030751007]]]], null, false),
    otherPoints = 
    /* color: #00ffff */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.MultiPolygon(
        [[[[0.3874809435244515, 5.94399848038035],
           [0.3874809435244515, 5.94399848038035],
           [0.3874809435244515, 5.94399848038035],
           [0.3874809435244515, 5.94399848038035]]],
         [[[0.3874809435244515, 5.94399848038035],
           [0.3874809435244515, 5.925558418658378],
           [0.419753282391639, 5.925558418658378],
           [0.419753282391639, 5.94399848038035]]],
         [[[0.2721244982119515, 5.926924370304081],
           [0.2721244982119515, 5.9050687388111145],
           [0.357955186688514, 5.9050687388111145],
           [0.357955186688514, 5.926924370304081]]],
         [[[0.6344409408179672, 5.837928246890271],
           [0.6344409408179672, 5.833146636495926],
           [0.6375308456031235, 5.833146636495926],
           [0.6375308456031235, 5.837928246890271]]],
         [[[0.6419940414039047, 5.8266572429027335],
           [0.6419940414039047, 5.822900191272106],
           [0.6462855758277328, 5.822900191272106],
           [0.6462855758277328, 5.8266572429027335]]],
         [[[0.9128044833109925, 5.916411675512024],
           [0.9128044833109925, 5.906849761215164],
           [0.9196709383891175, 5.906849761215164],
           [0.9196709383891175, 5.916411675512024]]],
         [[[0.3263417914498632, 5.786952437593809],
           [0.3263417914498632, 5.779779357495695],
           [0.3400747016061132, 5.779779357495695],
           [0.3400747016061132, 5.786952437593809]]],
         [[[-0.21982309656345933, 5.58833272242622],
           [-0.21982309656345933, 5.553479202638038],
           [-0.18892404871189683, 5.553479202638038],
           [-0.18892404871189683, 5.58833272242622]]],
         [[[-0.24728891687595933, 5.582865640484494],
           [-0.24728891687595933, 5.565097272263673],
           [-0.23630258875095933, 5.565097272263673],
           [-0.23630258875095933, 5.582865640484494]]],
         [[[-0.12643930750095933, 5.537076832134719],
           [-0.12643930750095933, 5.492651463214865],
           [-0.03168222742283433, 5.492651463214865],
           [-0.03168222742283433, 5.537076832134719]]],
         [[[-0.22737619714939683, 5.472146327932328],
           [-0.22737619714939683, 5.446855693129553],
           [-0.18892404871189683, 5.446855693129553],
           [-0.18892404871189683, 5.472146327932328]]],
         [[[-0.21501657800877183, 5.5345139205893465],
           [-0.21501657800877183, 5.530754963563433],
           [-0.20832178430759996, 5.530754963563433],
           [-0.20832178430759996, 5.5345139205893465]]],
         [[[-0.20377275781834214, 5.544338354476612],
           [-0.20377275781834214, 5.540237741067544],
           [-0.1983654244443187, 5.540237741067544],
           [-0.1983654244443187, 5.544338354476612]]],
         [[[-0.66107149527204, 5.702858137231309],
           [-0.66107149527204, 5.67416104533347],
           [-0.59240694449079, 5.67416104533347],
           [-0.59240694449079, 5.702858137231309]]],
         [[[-0.9472020450658647, 6.111484703554056],
           [-0.9472020450658647, 6.035012041628603],
           [-0.7439549747533647, 6.035012041628603],
           [-0.7439549747533647, 6.111484703554056]]],
         [[[-1.6008885685033647, 6.095098619861898],
           [-1.6008885685033647, 6.0623249525185035],
           [-1.3262303653783647, 6.0623249525185035],
           [-1.3262303653783647, 6.095098619861898]]],
         [[[-2.3534520450658647, 5.767273619734671],
           [-2.3534520450658647, 5.61968989204905],
           [-2.1721776310033647, 5.61968989204905],
           [-2.1721776310033647, 5.767273619734671]]],
         [[[-2.2051366153783647, 5.384572293434829],
           [-2.2051366153783647, 5.313472139214088],
           [-2.0623143497533647, 5.313472139214088],
           [-2.0623143497533647, 5.384572293434829]]],
         [[[-2.174949794166878, 4.894775050519882],
           [-2.174949794166878, 4.894304703164354],
           [-2.174091487282112, 4.894304703164354],
           [-2.174091487282112, 4.894775050519882]]],
         [[[-2.1773530534442216, 4.895587467900579],
           [-2.1773530534442216, 4.895330915150103],
           [-2.176022677772835, 4.895330915150103],
           [-2.176022677772835, 4.895587467900579]]],
         [[[-2.1811164479056515, 4.894886028106824],
           [-2.1811164479056515, 4.8948633721391275],
           [-2.181088510251925, 4.8948633721391275],
           [-2.181088510251925, 4.894886028106824]]],
         [[[-2.2176969504852195, 4.887998513620141],
           [-2.2176969504852195, 4.8858605467961445],
           [-2.21469287638854, 4.8858605467961445],
           [-2.21469287638854, 4.887998513620141]]],
         [[[-2.215036199142446, 4.8933006418970235],
           [-2.215036199142446, 4.890564064803005],
           [-2.2118604636688133, 4.890564064803005],
           [-2.2118604636688133, 4.8933006418970235]]],
         [[[-3.247738493347015, 5.183823396406446],
           [-3.247738493347015, 5.17954940012493],
           [-3.2346922286985773, 5.17954940012493],
           [-3.2346922286985773, 5.183823396406446]]],
         [[[-3.228512419128265, 5.177155949582111],
           [-3.228512419128265, 5.169633617490743],
           [-3.220787657165374, 5.169633617490743],
           [-3.220787657165374, 5.177155949582111]]],
         [[[-3.199844969177093, 5.1532209465917305],
           [-3.199844969177093, 5.149117712563168],
           [-3.1953817733763117, 5.149117712563168],
           [-3.1953817733763117, 5.1532209465917305]]],
         [[[-3.1195074447630304, 5.154417718192446],
           [-3.1195074447630304, 5.143817662754967],
           [-3.0920416244505304, 5.143817662754967],
           [-3.0920416244505304, 5.154417718192446]]],
         [[[-3.0824285873411554, 5.1523661083538155],
           [-3.0824285873411554, 5.1441596027845815],
           [-3.057366026305999, 5.1441596027845815],
           [-3.057366026305999, 5.1523661083538155]]],
         [[[-3.124313963317718, 5.192029388167072],
           [-3.124313963317718, 5.182797639935871],
           [-3.109207762145843, 5.182797639935871],
           [-3.109207762145843, 5.192029388167072]]],
         [[[-3.5002523788450617, 5.1821138013634025],
           [-3.5002523788450617, 5.150656428428104],
           [-3.4466940292356867, 5.150656428428104],
           [-3.4466940292356867, 5.1821138013634025]]]], null, false),
    classfilter = ee.Image("users/jackreid/classfilter_ghana"),
    mangroveLoss = ee.Image("users/jackreid/mangroveLoss_ghana"),
    class_mang_buffer = ee.Image("users/jackreid/class_mang_buffer_ghana"),
    anomalyMean = ee.Image("users/jackreid/anomalyMean_ghana");
// ========================================================================================================================================================
// ========================================================================================================================================================
// SECTION 1: LOAD, MASK, AND FORMAT DATA
// ========================================================================================================================================================
// ========================================================================================================================================================
    Map.setCenter(-0.668, 5.491, 9);
// 1.1 Select Various Inputs
  // Select Area of Interest (AOI)
    var aoi = ghanaregion;
  // Define Locations of Interest
    var loi = ee.FeatureCollection([
            loi1,
            loi2
            ]);
  // define years and dates to include in landsat image collection
    var startYear = 1998;     //@    what year do you want to start the time series 
    var endyear   = 2018;     //@    what year do you want to end the time series
    var startDay  = '04-01';  //@    what is the beginning of date filter | month-day
    var endDay    = '03-31';  //@    what is the end of date filter | month-day
  //DEFINE REFERENCE PERIOD
    var ref_start = '1999-08-31';
    var ref_end =  '2001-08-31';
  //DEFINE OBSERVATION PERIOD
    var observation_start = '2000-09-15';
    var observation_end =  '2018-09-15';
  // SET NDVI MEAN ANOMALY THRESHOLD TO BE CONSIDERED "POTENTIAL MANGROVE LOSS"
    var anomaly_threshold = -0.1;
// &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
// 1.2 Load Data
  // Load Landsat 8 surface reflectance data
    var l8sr = ee.ImageCollection('LANDSAT/LC08/C01/T1_SR');
  // Load Sentinel-2 Surface Reflectance Data
    var sentinel = ee.ImageCollection("COPERNICUS/S2_SR");
  // MANGROVE MAP 2015 (GMW 2015)
    var GBW2016 = ee.FeatureCollection(GMWtable);
  // MANGROVE MAP 2000 (Giri et al 2010)
    var mangrove = ee.Image(ee.ImageCollection('LANDSAT/MANGROVE_FORESTS').mean()).clip(aoi);
  // Buffer mangrove area to include regions around mangrove forests  
    var mang_buffer = mangrove.focal_max(2000,'square','meters');
  // CALCULATE AREAS OF MANGROVE LOSS
    // Reduce the region. The region parameter is the Feature geometry.
      var areaLoss = mangroveLoss.multiply(ee.Image.pixelArea().divide(10000)).reduceRegion({
        reducer: ee.Reducer.sum(),
        geometry: aoi,
        scale: 30,
        maxPixels: 1e15,
        tileScale:16
      });
  // Reduce the region. The region parameter is the Feature geometry.
      var area2000 = mangrove.multiply(ee.Image.pixelArea().divide(10000)).reduceRegion({
        reducer: ee.Reducer.sum(),
        geometry: aoi,
        scale: 30,
        maxPixels: 1e15,
        tileScale:16
      });
      var remainingMangrove = ee.Number(area2000.get('1')).subtract(ee.Number(areaLoss.get('1')))
  // The result is a Dictionary.  Print it.
  print(ee.Number(area2000.get('1')).multiply(10000).toLong().divide(100), 'Approximate Mangrove Area in 2000 (ha) - Giri et al 2010')
  print(ee.Number(areaLoss.get('Loss')).multiply(10000).toLong().divide(100), 'Approximate Mangrove Area Damaged (ha)');
  print(ee.Number(areaLoss.get('Loss')).divide(ee.Number(area2000.get('1'))).multiply(10000).toLong().divide(100), 'Approximate Percentage of Mangrove Area Damaged')
// ========================================================================================================================================================
// ========================================================================================================================================================
// SECTION 4: Displaying & Exporting
// ========================================================================================================================================================
// ========================================================================================================================================================
// 4.1 DISPLAYING MAPS
  // //Display initial maps of mangrove extent -- Section 1.2
    Map.addLayer(GBW2016,{},'2015 Mangrove');
  //   Map.addLayer(mangrove,{},'2000 Mangrove',false);
  //   Map.addLayer(mang_buffer,{},'Mangrove Buffer',false);
  // //Display elevation map -- Section 1.3
  //   Map.addLayer(srtm,{min:0, max:30},'SRTM Elevation',false);
  // // Display the flase color landsat and sentinel images -- Section 2.1
  //   Map.addLayer(composite2018, {bands: ['B5', 'B6', 'B3'], min: 0, max: 0.4,gamma:1.2},'False-Color Composite Landsat',false);
  //   Map.addLayer(compositeSentinel2018, {bands: ['B8', 'B11', 'B3'], min: 0, max: 4000},'False-Color Composite Sentinel');
  // // Display  Full Landsat Collection with NDVI -- Section 3.2
  //   Map.addLayer(collectionSR_wIndex.select('NDVI'),{},'Collection',false);
  // // Display classified image -- Section 2.3
  //   Map.addLayer(classifiedrf2018.updateMask(classifiedrf2018.eq(1)).updateMask(elevationMask), {palette: ['yellow']}, 'Mangrove 2018 - Landsat',false);
    Map.addLayer(classfilter, {palette: ['blue']}, 'Mangrove 2018 - Sentinel');
    Map.addLayer(class_mang_buffer, {palette: ['orange']},'buffer');
    //// Map.addLayer(classifiedrf2018Sentinel.randomVisualizer(), {}, 'Mangrove 2018 - Sentinel',false);
  // // Display median values for the reference and observation periods -- Section 3.2
  //   var viz = {"opacity":1,"bands":["B5","B4","B3"],"min":0,"max":5000,"gamma":1};
  //   Map.addLayer(Refmedian,viz,'Median  Reference Period',false);
  //   Map.addLayer(Obsmedian,viz,'Median Observation Period',false);
  // Display mean anomaly and the potential magrove losses -- Section 3.3
    var viz = {min: -0.250, max: 0.250,palette: ['FF0000', '000000', '00FF00']}
    Map.addLayer(anomalyMean,viz,'NDVI anomaly mean');
    Map.addLayer(mangroveLoss, {palette:['orange']},'Potential Mangrove Loss');
  // Display NDVI time series chart for Locations of Interest
// &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
// set position of panel
var legend = ui.Panel({
style: {
position: 'bottom-left',
padding: '8px 15px'
}
});
// Create legend title
var legendTitle = ui.Label({
value: 'NDVI Anomaly Mean',
style: {
fontWeight: 'bold',
fontSize: '18px',
margin: '0 0 4px 0',
padding: '0'
}
});
// Add the title to the panel
legend.add(legendTitle);
// create the legend image
var lon = ee.Image.pixelLonLat().select('latitude');
var gradient = lon.multiply((viz.max-viz.min)/100.0).add(viz.min);
var legendImage = gradient.visualize(viz);
// create text on top of legend
var panel = ui.Panel({
widgets: [
ui.Label(viz['max'])
],
});
legend.add(panel);
// create thumbnail from the image
var thumbnail = ui.Thumbnail({
image: legendImage,
params: {bbox:'0,0,10,100', dimensions:'10x200'},
style: {padding: '1px', position: 'bottom-center'}
});
// add the thumbnail to the legend
legend.add(thumbnail);
// create text on top of legend
var panel = ui.Panel({
widgets: [
ui.Label(viz['min'])
],
});
legend.add(panel);
Map.add(legend);